class t{constructor(e,i={},s=!1){this.$root=t.make(e,{...i,ctx:this},s)}static make(s,a={},n=!1){s||=a.tag;let r="svg"==s||a.svg||n?document.createElementNS("http://www.w3.org/2000/svg",s||"svg"):document.createElement(s||"div");t.update(r,a);for(let i of e)Object.defineProperty(r,i,{value:(...e)=>t[i](r,...e)});return i.forEach(t=>{t in a&&(r["_"+t]=a[t].bind(r.ctx,{el:r,ctx:r.ctx}))}),r._onResize&&(r._ro=new ResizeObserver(t=>{for(const e of t)if(e.target===r){r._onResize();break}}),r._ro.observe(r)),r}static update(t,e){if(!h.node(t)||!h.obj(e))return t;t.ctx=e.ctx??e.context??t.ctx;for(let[i,s]of Object.entries(e))u(t,i,s);return t._onUpdate?.(),e.also?.call(t.ctx,{el:t,ctx:t.ctx}),t}static mount(t,e){t&&(null==e?(t.parentNode?.removeChild(t),t._mounted=t._rendered=!1):t.parentNode!==e&&(e.appendChild(t),a(t)))}static clear(e,i=!0){if(e)for(;e.firstChild;)i&&t.clear(e.firstChild,!0),t.remove(e.firstChild,!1)}static remove(e,s=!0){e&&(s&&t.clear(e,!0),t.release(e),t.unbind(e),e._ro?.disconnect(),e._onDestroy?.(),i.forEach(t=>e["_"+t]=null),e.parentNode?.removeChild(e))}static replace(e,i,s=!0){return e&&(e.parentNode?.replaceChild(i,e),i&&(a(i),s&&(i.ctx=e?.ctx)),t.remove(e)),i}static release(t){t&&(Object.values(t._events??{}).forEach(({ev:e,fn:i,opts:s})=>t.removeEventListener(e,i,s)),t._events={})}static unbind(t){t&&(Object.values(t._states??{}).forEach(t=>t()),t._states={})}static makeShadow(e,i={},s=""){return e&&h.obj(i)?(h.node(e)||(e=document.createElement(e)),e.attachShadow({mode:"open"}),t.update(e.shadowRoot,{ctx:i.context??i.ctx,child:[{tag:"style",$:"style",text:s},i.child,i.children]}),delete i.child,delete i.children,t.update(e,i)):null}static setTemplate(e,i,s){t.templates.set(e,(...e)=>t.make(i,s(...e)))}static useTemplate(e,...i){const s=t.templates.get(e);return s?s(...i):null}static templates=new Map;static config=t.update}const e=["update","mount","clear","remove"],i=["onMount","onRender","onUpdate","onResize","onDestroy"],s=new Set(["tag","get","also","context","ctx","svg",...i]);function a(t,e=50){const i=()=>{t.isConnected&&(t._mounted||(t._mounted=!0,t._onMount?.()),t.clientWidth||t.clientHeight)?t._rendered||(t._rendered=!0,t._onRender?.()):e--&&requestAnimationFrame(i)};(t._onMount||t._onRender)&&i()}const n={children:"child",children_r:"child_r",text:"textContent",html:"innerHTML"},r={push(t,e){e.push(t)},$(t,e){t.ctx&&(t.ctx["$"+e]=t)},attrs(t,e){o("attrs",t,e,(e,i)=>t.setAttribute(e,i),e=>t.removeAttribute(e))},data(t,e){o("data",t,e,(e,i)=>t.dataset[e]=i,e=>delete t.dataset[e])},props(t,e){for(let i in e){let s=c(t,i,null,e[i]);t[i]=["min","max","step","selectedIndex"].includes(i)||"value"==i&&["number","range"].includes(t.type)?null==s||""===s||Number.isNaN(s)?"":+s:s??""}},transition(t,e){const{duration:i=300,easing:s="ease",delay:a=0,onEnd:n=null,...o}=e;t.style.transition=Object.keys(o).map(t=>`${t} ${i}ms ${s} ${a}ms`).join(", "),n&&r.events(t,{transitionend:{handler:n,once:!0}}),requestAnimationFrame(()=>r.style(t,o))},events(t,e){for(let i in e){let s=e[i],a={};if(h.obj(s)&&(a=s,s=s.handler,!s))continue;const n=e=>s.call(t.ctx,Object.assign(e,{el:t,ctx:t.ctx}));if(!a.once){const e=(t._events??={})[i];e&&t.removeEventListener(i,e.fn,e.opts),t._events[i]={ev:i,fn:n,opts:a}}t.addEventListener(i,n,a)}},events_r(e,i){t.release(e),r.events(e,i)},child(t,e){d(t,e)},child_r(e,i){t.clear(e),r.child(e,i)},style(t,e){l("style",t,e,e=>t.style.cssText+=e+";",(e,i)=>{e.startsWith("--")?t.style.setProperty(e,i):t.style[e]=i})},style_r(t,e){t.style.cssText="",r.style(t,e)},class(t,e){h.arr(e)&&(e=Object.fromEntries(e.filter(Boolean).map(t=>[t,!0]))),l("class",t,e,e=>e.split(/\s+/).forEach(e=>e&&t.classList.add(e)),(e,i)=>i?t.classList.add(e):t.classList.remove(e))},class_r(t,e){t.className="",r.class(t,e)},parent(e,i){t.mount(e,i)}};function o(t,e,i,s,a){for(let n in i){let r=c(e,t,n,i[n]);null==r?a(n):s(n,String(r))}}function l(t,e,i,s,a){if(h.str(i))s(i);else for(let s in i)"_raw"==s?r[t](e,i[s]):a(s,c(e,t,s,i[s]))}function d(e,i){i&&(h.str(i)?e.insertAdjacentHTML("beforeend",i):h.arr(i)?i.forEach(t=>d(e,t)):h.node(i)?t.mount(i,e):i instanceof t?t.mount(i.$root,e):h.obj(i)&&t.make(null,{ctx:e.ctx,...i,parent:e},e instanceof SVGElement))}function c(t,e,i,s){if(h.func(s))return s.call(t.ctx,{el:t,ctx:t.ctx});if(h.arr(s)&&h.state(s[0]))return s.map(s=>c(t,e,i,s))[0];if(h.state(s)){const a=(a,n)=>{n=s.map({el:t,ctx:t.ctx,name:a,value:n}),u(t,e,i?{[i]:n}:n),t._onUpdate?.()},n=`${e}.${i}.${s.name}`;let r=(t._states??={})[n];return r&&r(),t._states[n]=s._state.subscribe(s.name,a),s.map({el:t,ctx:t.ctx,name:s.name,value:s._state[s.name]})}return s}function u(t,e,i){if(s.has(e))return;(e=n[e]??e).startsWith("on")?(i={[e.slice(2).toLowerCase()]:i},e="events"):i=c(t,e,null,i);const a=r[e];null!=i&&a?a(t,i):r.props(t,{[e]:i})}const h={func:t=>"function"==typeof t,str:t=>"string"==typeof t,arr:t=>Array.isArray(t),node:t=>t instanceof Node,obj:t=>null!==t&&"object"==typeof t,state:t=>t&&t._state};class _{static svg=(t={},e={})=>({tag:"svg",...e,attrs:t});static rect=(t,e,i,s,a,n,r={},o={})=>({tag:"rect",...o,attrs:{...r,x:t,y:e,width:i,height:s,rx:a,ry:n}});static circle=(t,e,i,s={},a={})=>({tag:"circle",...a,attrs:{...s,cx:t,cy:e,r:i}});static line=(t,e,i,s,a={},n={})=>({tag:"line",...n,attrs:{...a,x1:t,y1:e,x2:i,y2:s}});static polyline=(t,e={},i={})=>({tag:"polyline",...i,attrs:{...e,points:t}});static polygon=(t,e={},i={})=>({tag:"polygon",...i,attrs:{...e,points:t}});static path=(t,e={},i={})=>({tag:"path",...i,attrs:{...e,d:t}});static text=(t,e,i,s={},a={})=>({tag:"text",...a,text:t,attrs:{...s,x:e,y:i}});static make=(e,i)=>t.make(e,i,!0);static update=t.update;static config=t.update}Object.getOwnPropertyNames(_).forEach(t=>_["make_"+t]=(...e)=>_.make(null,_[t](...e)));const p=new Map;class g{constructor(t={}){this._data={},this._subs=new Map,this.addStates(t)}addStates(t){for(const e in t)e in this||e in this._data||(this._data[e]=t[e],Object.defineProperty(this,e,{get:()=>this._data[e],set:t=>{if(Object.is(this._data[e],t))return;this._data[e]=t;const i=this._subs.get(e);i&&i.forEach(i=>i(e,t))}}))}hasState(t){return t in this._data}bind(t,e=t=>t.value){return{_state:this,name:t,map:e}}subscribe(t,e){return this._subs.has(t)||this._subs.set(t,new Set),this._subs.get(t).add(e),()=>this._subs.get(t).delete(e)}}class b{constructor(t,e){this._default=t,this._state=new g({value:t,label:e,hidden:!1})}get label(){return this._state.label}set label(t){return this._state.label=t}get value(){return this._state.value}set value(t){return this._state.value=t}get input(){return this.$input}display(t){this._state.hidden=!t}show(){this.display(!0)}hide(){this.display(!1)}remove(){this.$container.remove()}default(){this._state.value=this._default}}class m extends b{constructor(t,e){super(t,e)}set options(t){this._state.options=y(t)}get options(){return this._state.options.map(t=>t.text)}reset(){this.value=0}get text(){return this.options[this.value]}}class f extends b{constructor(t,e){super(t,e)}set valueInt(t){return this.value="#"+t.toString(16).padStart(6,0)}get valueInt(){return parseInt(this.value.slice(1),16)}}class x extends b{constructor(t,e){super(t,e),this._state.addStates({filename:"...",active:!1})}}class v{constructor(e={}){!function(t,e=""){if(e||(e=function(t){let e=5381;for(let i=0;i<t.length;i++)e=(e<<5)+e+t.charCodeAt(i),e|=0;return e.toString(36)}(t)),p.has(e))return;const i=document.createElement("style");i.textContent=t,document.head.appendChild(i),p.set(e,i)}(v.css);const i=t=>null==t?0:"string"==typeof t?t:t+"px";let s={};null==(e={width:"200px",parent:document.body,title:"",zIndex:3,theme:"light",autoVar:!0,class:"",...e}).x&&null==e.y||(s.left=i(e.x),s.top=i(e.y),s.position="absolute"),this._autoVar=e.autoVar,this._class=e.class,this._dragCount=0,this._lastDragState=0;const a=(t,e)=>{t.preventDefault(),t.stopPropagation(),this._dragCount=null===e?0:Math.max(0,this._dragCount+e);const i=0!=this._dragCount;this._lastDragState!=i&&(this._lastDragState=i,this._widgets.forEach(t=>{t instanceof x&&(t._state.active=0!=this._dragCount)}))};return t.make("div",{ctx:this,$:"ui",parent:e.parent,style:{zIndex:e.zIndex,width:e.width+("string"==typeof e.width?"":"px"),...s},child:[{$:"title",text:e.title,class:"ui_title_bar"},{$:"widgets",class:"ui_content"}],events:{dragenter:t=>a(t,1),dragover:t=>a(t,0),dragleave:t=>a(t,-1),drop:t=>a(t,null)}}),this.setTheme(e.theme)}setTheme(t){return this.$ui.className=`ui_main theme-${t} ${this._class}`,this}useWheel(t){this._wheel=t}destroy(){this.removeAll(),this.$ui&&(this.$ui.remove(),this.$ui=null,this._widgets=new Map)}setLabels(t){for(let e in t)this._widgets.has(e)&&(this.widget(e).label=t[e])}toObject(){let t={};return this._widgets.forEach((e,i)=>t[i]=e.value),t}toJson(){return JSON.stringify(this.toObject())}fromObject(t){for(let e in t)this._widgets.has(e)&&(this.widget(e).value=t[e])}fromJson(t){this.fromObject(JSON.parse(t))}widget(t){return this._widgets.get(t)}getWidget=t=>this.widget(t);control=t=>this.widget(t);get(t){return this._widgets.has(t)?this.widget(t).value:null}set(t,e){return this._widgets.has(t)&&(this.widget(t).value=e),e}remove(t){"string"==typeof t&&(t=[t]);for(let e of t)this._widgets.has(e)&&(this.widget(e).remove(),this._widgets.delete(e),delete this[e],delete this[e+"Text"])}removeAll(){this.remove(Array.from(this._widgets.keys())),t.clear(this.$widgets)}onChange(t){this._cb=t}addSwitch(e,i,s,a){if(e=this._checkID(e),this._widgets.has(e))return this;const n=new b(Boolean(s),i);return t.make("div",this._getWidget(n,{tag:"label",class:"ui_checkbox_cont",child:[{tag:"label",text:n._state.bind("label")},{tag:"div",class:"ui_checkbox",child:{tag:"label",child:[{tag:"input",type:"checkbox",$:"input",checked:n._state.bind("value"),onChange:this._handleValue(n,e,t=>t.checked,a)},{tag:"span"}]}}]})),this._widgets.set(e,n),this._addSetGet(e),this}addNumber(e,i,s,a,n){if(e=this._checkID(e),this._widgets.has(e))return this;const r=new b(k(s),i);return t.make("div",this._getContainer(r,{tag:"input",type:"number",$:"input",class:"ui_input_base ui_input",step:a??1,value:r._state.bind("value"),onInput:this._handleValue(r,e,t=>k(t.value),n),onMousewheel:t=>{this._wheel||(t.preventDefault(),window.scrollBy({top:t.deltaY,behavior:"smooth"}))}})),this._widgets.set(e,r),this._addSetGet(e),this}addText(e,i,s,a){if(e=this._checkID(e),this._widgets.has(e))return this;const n=new b(w(s),i);return t.make("div",this._getContainer(n,{tag:"input",type:"text",$:"input",class:"ui_input_base ui_input",value:n._state.bind("value"),onInput:this._handleValue(n,e,t=>w(t.value),a)})),this._widgets.set(e,n),this._addSetGet(e),this}addInput=(...t)=>this.addText(...t);addSlider(e,i,s,a,n,r,o){if(e=this._checkID(e),this._widgets.has(e))return this;const l=new b(k(s),i);return t.make("div",this._getContainer(l,{class:"ui_range_cont",child:{tag:"input",type:"range",$:"input",class:"ui_range",min:a,max:n??100,step:r??1,value:l._state.bind("value"),onInput:this._handleValue(l,e,t=>k(t.value),o),onMousewheel:t=>{this._wheel&&(t.stopPropagation(),t.preventDefault(),t.el.value=t.el.valueAsNumber+Number(t.el.step)*(t.deltaY>0?-1:1),t.el.dispatchEvent(new Event("input")))}}},!0)),this._widgets.set(e,l),this._addSetGet(e),this}addRange=(...t)=>this.addSlider(...t);addArea(e,i,s,a,n=5){if(e=this._checkID(e),this._widgets.has(e))return this;const r=new b(w(s),i);return t.make("div",this._getContainer(r,{tag:"textarea",$:"input",class:"ui_input_base ui_textarea",rows:n,value:r._state.bind("value"),onInput:this._handleValue(r,e,t=>w(t.value),a)})),this._widgets.set(e,r),this._addSetGet(e),this}addHTML(e,i,s){if(e=this._checkID(e),this._widgets.has(e))return this;const a=new b(w(s),i);return t.make("div",this._getContainer(a,{$:"input",html:a._state.bind("value")})),this._widgets.set(e,a),this._addSetGet(e),this}addElement(e,i,s){if(e=this._checkID(e),this._widgets.has(e))return this;const a=new b(s,i);return t.make("div",this._getContainer(a,{$:"input",child_r:a._state.bind("value")})),this._widgets.set(e,a),this._addSetGet(e),this}addSelect(e,i,s,a){if(e=this._checkID(e),this._widgets.has(e))return this;const n=new m(0,i);return n._state.addStates({options:y(s)}),t.make("div",this._getContainer(n,{tag:"select",$:"input",class:"ui_input_base ui_select",value:n._state.bind("value"),child_r:n._state.bind("options"),onChange:t=>{let i=t.el.selectedIndex,s=t.el.options[i].text;n._state.value=i,this._cb(e,i,s),a&&a(i,s)},onMousewheel:t=>{if(!this._wheel)return;t.stopPropagation(),t.preventDefault();let e=t.el.selectedIndex;if(t.deltaY<0&&e>0)e--;else{if(!(t.deltaY>0&&e<t.el.options.length-1))return;e++}t.el.value=e,t.el.dispatchEvent(new Event("change"))}})),this._widgets.set(e,n),this._addSetGet(e)&&Object.defineProperty(this,e+"Text",{get:()=>this.widget(e).text,configurable:!0}),this}addButton(e,i,s){if(e=this._checkID(e),this._widgets.has(e))return this;const a=new b(0,i);return t.make("div",this._getWidget(a,this._getButton(a,e,s),"ui_button_cont")),this._widgets.set(e,a),this}addButtons(e){let i=t.make("div",{class:"ui_button_cont",parent:this.$widgets});return t.update(i,{child:Object.entries(e).map(([t,e])=>{if(t=this._checkID(t),this._widgets.has(t))return;Array.isArray(e)||(e=[e,null]);let[s,a]=e;const n=new b(0,s);return n.$container=i,this._widgets.set(t,n),this._getButton(n,t,a)})}),this}addFile(e,i,s){if(e=this._checkID(e),this._widgets.has(e))return this;const a=(t,i,s)=>{let a=Array.from(i).map(t=>t.name).join(", ");if(t._state.filename=a||"...",!i.length)return;let n=1==i.length?i[0]:i;t._state.value=n,this._cb(e,n),s&&s(n)},n=new x(null,i);let r=t.make("div",this._getContainer(n,[{tag:"input",type:"file",$:"input",class:"ui_file_chooser",onChange:()=>a(n,n.$input.files,s),attrs:{multiple:!0}},{tag:"label",class:{_raw:"ui_input_base ui_file_chooser_label",active:n._state.bind("active")},text:n._state.bind("filename")}]));return t.update(r,{onClick:()=>n.$input.click(),onDrop:t=>a(n,t.dataTransfer.files,s)}),this._widgets.set(e,n),this._addSetGet(e),this}addColor(e,i,s,a){if(e=this._checkID(e),this._widgets.has(e))return this;const n=new f(s??"#000",i);let r=t.make("div",this._getContainer(n,null,!0));return t.update(r,{class:"ui_color_cont",child:{tag:"input",type:"color",$:"input",class:"ui_color",value:n._state.bind("value"),attrs:{"colorpick-eyedropper-active":!1},onInput:this._handleValue(n,e,t=>t.value,a)}}),this._widgets.set(e,n),this._addSetGet(e),this}addLabel(e,i,s){if(e=this._checkID(e),this._widgets.has(e))return this;const a=new b(w(s),i);return t.make("div",this._getContainer(a,null,!0)),this._widgets.set(e,a),this._addSetGet(e),this}addSpace(e=5){return t.make("div",{style:`height: ${e}px`,parent:this.$widgets}),this}_addSetGet(t){return!(!this._autoVar||!t||"function"==typeof this[t]||(Object.defineProperty(this,t,{get:()=>this.get(t),set:e=>this.set(t,e),configurable:!0}),0))}_checkID(t){return t||"_empty_"+this._count++}_getWidget=(t,e,i="ui_widget")=>({ctx:t,$:"container",class:{_raw:i,hidden:t._state.bind("hidden")},parent:this.$widgets,child:e});_getContainer(t,e,i){return this._getWidget(t,[{class:"ui_label",child:[{tag:"b",text:t._state.bind("label")},i&&{tag:"span",text:": "},i&&{tag:"span",text:t._state.bind("value")}]},e])}_getButton=(t,e,i)=>({tag:"button",class:"ui_button",text:t._state.bind("label"),onClick:()=>{this._cb(e),i&&i()}});_handleValue(t,e,i,s){return a=>{const n=i(a.el);t._state.value=n,this._cb(e,n),s&&s(n)}}_wheel=!1;_widgets=new Map;_count=0;_cb=()=>{};static css='.ui_main.theme-light{--border:#aaa;--back:#fff;--mid:#ccc;--tab:#f0f0f0;--font:#000;--font-mid:#555;--thumb:var(--back)}.ui_main.theme-dark{--border:#484d53;--back:rgb(30, 35, 42);--mid:#22272E;--tab:#2D333B;--font:#ccc;--font-mid:#999;--thumb:var(--font-mid)}.ui_main{background-color:var(--mid);text-align:left;font:12px sans-serif;user-select:none;border:none;border-radius:6px}.ui_main.noback{background:none}.ui_main.noback .ui_widget{border:1px solid var(--mid);margin:5px 0}.ui_main.noback .ui_title_bar{display:none}.ui_main.noback .ui_button_cont{margin:5px 0}.ui_main.noback .ui_button{border:1px solid var(--mid)}.ui_content{overflow-y:auto;border-radius:6px}.ui_title_bar{text-align:center;font-weight:700;border:none;background:var(--tab);color:var(--font);font-size:15px;border-radius:5px 5px 0 0}.ui_title_bar:not(:empty){padding:4px}.ui_widget{margin:5px;padding:5px;border:none;position:relative;background:var(--tab);color:var(--font);border-radius:5px}.ui_widget.hidden{display:none}.ui_range_cont{display:flex;align-items:center;padding:10px 0 6px 0}.ui_range{appearance:none;box-sizing:border-box;margin:0;padding:0;width:100%;height:2px;background:var(--border);cursor:pointer;touch-action:none}.ui_range::-webkit-slider-thumb{appearance:none;background:var(--thumb);width:16px;height:16px;border-radius:50%;box-shadow:0 0 4px #0000005a}.ui_range::-moz-range-thumb{border:none;background:var(--thumb);width:16px;height:16px;border-radius:50%}.ui_button_cont{margin:5px;gap:5px;display:flex}.ui_button_cont.hidden{display:none}.ui_button{cursor:pointer;background:var(--tab);color:var(--font-mid);height:26px;border-radius:4px;width:100%;border:none}.ui_button:hover{filter:brightness(.96)}.ui_button:active{background:var(--back)}.ui_checkbox_cont{cursor:pointer;display:flex;align-items:center;justify-content:space-between}.ui_checkbox_cont label{font-weight:700;pointer-events:none}.ui_checkbox{display:inline-block}.ui_checkbox label{display:flex;align-items:center;cursor:pointer;user-select:none}.ui_checkbox input{display:none}.ui_checkbox span{width:18px;height:18px;border:1px solid var(--border);border-radius:4px;background-color:var(--back);position:relative}.ui_checkbox input:checked+span::after{content:"âœ“";position:absolute;left:3px;top:-2px;font-size:16px;color:var(--font);font-weight:700}.ui_label{user-select:none;-webkit-user-select:none;cursor:default}.ui_input_base{width:100%;box-sizing:border-box;background:var(--back);outline:none;color:var(--font-mid);border:1px solid var(--border);transition:border-color 0.1s;border-radius:4px;margin-top:4px}.ui_input_base:focus{border-color:var(--font-mid)}.ui_input{height:24px;padding:5px;line-height:24px}.ui_select{height:24px;padding:0 2px;cursor:pointer}.ui_textarea{resize:vertical;padding:3px 5px}.ui_textarea::-webkit-scrollbar{width:7px;height:7px}.ui_textarea::-webkit-scrollbar-track{background:none}.ui_textarea::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px}.ui_file_chooser_label{padding:5px;height:24px;display:block;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ui_file_chooser_label.active{border-color:var(--font-mid)}.ui_file_chooser{display:none}.ui_color_cont{display:flex;align-items:center;justify-content:space-between}.ui_color_cont .ui_label{margin:0}.ui_color{cursor:pointer;padding:0;margin:0;border:none;background:none;height:22px;width:22px}'}const w=t=>String(t??""),k=t=>Number.isFinite(+t)?+t:0,y=t=>t.map((t,e)=>({tag:"option",text:t,value:e}));export{v as default};